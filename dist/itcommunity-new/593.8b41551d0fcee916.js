"use strict";(self.webpackChunkITCommunity_new=self.webpackChunkITCommunity_new||[]).push([[593],{8593:(k,p,a)=>{a.r(p),a.d(p,{AuthModule:()=>q});var d=a(6956),c=a(1901),h=a(8692),t=a(92),g=a(1528),s=a(3568),e=a(4537),f=a(6707),T=a(5934),u=a(4032),v=a(9549),Z=a(9638);const w=function(o){return{second:o}};let I=(()=>{class o{constructor(r,n,i,m,y,N){this.translateService=r,this.authService=n,this.localStorageHelperService=i,this.userService=m,this.router=y,this.notifyService=N,this.formOTP=this.initFormOTP(),this.secondTimeline=120}ngOnInit(){this.translateService.use(this.translateService.currentLang||"vi"),this.startTime()}startTime(){this.secondTimeline=120;const r=setInterval(()=>{this.secondTimeline>0?this.secondTimeline--:clearInterval(r)},1e3)}initFormOTP(){return new t.cw({number1:new t.NI("",[t.kI.required,t.kI.minLength(1),t.kI.maxLength(1)]),number2:new t.NI("",[t.kI.required,t.kI.minLength(1),t.kI.maxLength(1)]),number3:new t.NI("",[t.kI.required,t.kI.minLength(1),t.kI.maxLength(1)]),number4:new t.NI("",[t.kI.required,t.kI.minLength(1),t.kI.maxLength(1)]),number5:new t.NI("",[t.kI.required,t.kI.minLength(1),t.kI.maxLength(1)]),number6:new t.NI("",[t.kI.required,t.kI.minLength(1),t.kI.maxLength(1)])})}nextValue(r){switch(r){case"number1":""!==this.formOTP.getRawValue().number1&&document.getElementById("number2")?.focus();break;case"number2":""!==this.formOTP.getRawValue().number2?document.getElementById("number3")?.focus():document.getElementById("number1")?.focus();break;case"number3":""!==this.formOTP.getRawValue().number3?document.getElementById("number4")?.focus():document.getElementById("number2")?.focus();break;case"number4":""!==this.formOTP.getRawValue().number4?document.getElementById("number5")?.focus():document.getElementById("number3")?.focus();break;case"number5":""!==this.formOTP.getRawValue().number5?document.getElementById("number6")?.focus():document.getElementById("number4")?.focus();break;case"number6":""!==this.formOTP.getRawValue().number6?this.submit():document.getElementById("number5")?.focus()}}submit(){const r=this.formOTP.getRawValue().number1+this.formOTP.getRawValue().number2+this.formOTP.getRawValue().number3+this.formOTP.getRawValue().number4+this.formOTP.getRawValue().number5+this.formOTP.getRawValue().number6,n=this.localStorageHelperService.getUser();this.authService.verifyOTP(n.email,parseInt(r)).pipe((0,g.w)(i=>this.authService.login(n,!0)),(0,g.w)(i=>(this.localStorageHelperService.saveToken(i.accessToken.toString()),this.localStorageHelperService.saveRefreshToken(i.refreshToken.toString()),this.localStorageHelperService.saveIsVerify(i.isConfirmEmail),this.userService.getMe())),(0,s.K)(i=>(this.notifyService.error("Can not verify your email please try again!","Error"),this.formOTP.reset(),document.getElementById("number1")?.focus(),i))).subscribe(i=>{this.localStorageHelperService.addUser(i),this.router.navigate(["/home/newest/posts"])})}resendOTP(){this.startTime()}}return o.\u0275fac=function(r){return new(r||o)(e.Y36(f.sK),e.Y36(c.e),e.Y36(d.w),e.Y36(T.K),e.Y36(u.F0),e.Y36(v.c))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-validate-email"]],decls:25,vars:18,consts:[[1,"p-5","container-lg"],[1,"p-5","text-center"],[1,"d-flex","justify-content-center","mt-4"],["src","assets/images/logo-header-250x250.png","alt","","width","200"],[1,"text-secondary","mx-5","my-4"],[1,"d-flex","justify-content-center","mt-4",3,"formGroup"],["type","text","name","","id","number1","maxlength","1","formControlName","number1",1,"input-otp-item",3,"keyup"],["type","text","name","","id","number2","maxlength","1","formControlName","number2",1,"input-otp-item",3,"keyup"],["type","text","name","","id","number3","maxlength","1","formControlName","number3",1,"input-otp-item",3,"keyup"],["type","text","name","","id","number4","maxlength","1","formControlName","number4",1,"input-otp-item",3,"keyup"],["type","text","name","","id","number5","maxlength","1","formControlName","number5",1,"input-otp-item",3,"keyup"],["type","text","name","","id","number6","maxlength","1","formControlName","number6",1,"input-otp-item",3,"keyup"],[1,"mt-3"],[1,"my-2"],["mat-raised-button","","color","primary",3,"click"]],template:function(r,n){1&r&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2),e._UZ(3,"img",3),e.qZA(),e.TgZ(4,"h1"),e._uU(5),e.ALo(6,"translate"),e.qZA(),e.TgZ(7,"p",4),e._uU(8),e.ALo(9,"translate"),e.qZA(),e.TgZ(10,"form",5)(11,"input",6),e.NdJ("keyup",function(){return n.nextValue("number1")}),e.qZA(),e.TgZ(12,"input",7),e.NdJ("keyup",function(){return n.nextValue("number2")}),e.qZA(),e.TgZ(13,"input",8),e.NdJ("keyup",function(){return n.nextValue("number3")}),e.qZA(),e.TgZ(14,"input",9),e.NdJ("keyup",function(){return n.nextValue("number4")}),e.qZA(),e.TgZ(15,"input",10),e.NdJ("keyup",function(){return n.nextValue("number5")}),e.qZA(),e.TgZ(16,"input",11),e.NdJ("keyup",function(){return n.nextValue("number6")}),e.qZA()(),e.TgZ(17,"div",12)(18,"i"),e._uU(19),e.ALo(20,"translate"),e.qZA()(),e.TgZ(21,"div",13)(22,"button",14),e.NdJ("click",function(){return n.resendOTP()}),e._uU(23),e.ALo(24,"translate"),e.qZA()()()()),2&r&&(e.xp6(5),e.Oqu(e.lcZ(6,7,"WELCOME")),e.xp6(3),e.hij(" ",e.lcZ(9,9,"VALIDATE_EMAIL_SUB_HEADER")," "),e.xp6(2),e.Q6J("formGroup",n.formOTP),e.xp6(8),e.ekj("text-danger",0===n.secondTimeline),e.xp6(1),e.hij(" ( ",e.xi3(20,11,"TIME_VERIFY_OTP",e.VKq(16,w,n.secondTimeline))," ) "),e.xp6(4),e.Oqu(e.lcZ(24,14,"RESEND_OTP")))},dependencies:[t._Y,t.Fj,t.JJ,t.JL,t.nD,t.sg,t.u,Z.lW,f.X$],styles:[".input-otp-item[_ngcontent-%COMP%]{width:40px;height:50px;border:1px solid #000000;border-radius:5px;text-align:center;font-size:20px;font-weight:600;color:#000;margin:0 5px;padding:0;outline:none;-webkit-appearance:none;appearance:none}"]}),o})();var A=a(4882),C=a(5725),b=a(4945);const E=function(){return["/auth/login"]};let S=(()=>{class o{constructor(r,n,i,m){this.authService=r,this.router=n,this.localStorageHelperService=i,this.notifyService=m,this.infoRegister=this.initFormRegister()}ngOnInit(){}initFormRegister(){return new t.cw({username:new t.NI("",[t.kI.required,t.kI.minLength(6),t.kI.maxLength(50),t.kI.pattern(/^[a-zA-Z0-9]+$/)]),password:new t.NI("",[t.kI.required,t.kI.minLength(6),t.kI.maxLength(50)]),email:new t.NI("",[t.kI.required,t.kI.email]),age:new t.NI("",[t.kI.required,t.kI.pattern(/^[0-9]+$/)]),gender:new t.NI("",[t.kI.required]),fullname:new t.NI("",[t.kI.required,t.kI.minLength(6),t.kI.maxLength(50),t.kI.pattern(/^[a-zA-Z0-9\s]+$/)]),confirmPassword:new t.NI("",[t.kI.required,t.kI.minLength(6),t.kI.maxLength(50)])})}comparePassword(){const r=this.infoRegister.value.password,n=this.infoRegister.value.confirmPassword;return console.log(r,n),!(!r||!n||r!==n)}register(){const r=new C.n;r.username=this.infoRegister.value.username,r.password=this.infoRegister.value.password,r.email=this.infoRegister.value.email,r.age=this.infoRegister.value.age,r.gender=this.infoRegister.value.gender,r.fullname=this.infoRegister.value.fullname,this.authService.register(r).pipe((0,A.z)(n=>(r&&this.localStorageHelperService.addUser(r),this.authService.sendOTP(r.username))),(0,s.K)(n=>(this.notifyService.error("Register failed please try again!","Error"),(0,b.of)(n)))).subscribe(n=>{this.router.navigate(["/auth/validate-email"])})}isControlValid(r,n){const i=r.controls[n];return i.valid&&(i.dirty||i.touched)}isControlInvalid(r,n){const i=r.controls[n];return i.invalid&&(i.dirty||i.touched)}controlHasError(r,n,i){const m=r.controls[i];return m.hasError(n)&&(m.dirty||m.touched)}isControlTouched(r,n){const i=r.controls[n];return i.dirty||i.touched}}return o.\u0275fac=function(r){return new(r||o)(e.Y36(c.e),e.Y36(u.F0),e.Y36(d.w),e.Y36(v.c))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-register"]],decls:74,vars:32,consts:[[1,"p-5","bg-image",2,"background-image","url('https://mdbootstrap.com/img/new/textures/full/171.jpg')","height","300px"],[1,"card","mx-4","mx-md-5","shadow-5-strong",2,"margin-top","-160px","background","hsla(0, 0%, 100%, 0.8)","backdrop-filter","blur(30px)"],[1,"card-body","py-5","px-md-5"],[1,"row","d-flex","justify-content-center"],[1,"col-lg-6"],[1,"d-flex","justify-content-center"],["src","../../../../assets/images/logo-header-250x250.png","width","100","alt",""],[1,"text-center"],[1,"fw-bold","mb-5"],[3,"formGroup"],[1,"row"],[1,"col-md-6","mb-4"],[1,"form-outline"],["for","username",1,"form-label"],["type","text","id","username","formControlName","username",1,"form-control","is-invalid"],["for","fullname",1,"form-label"],["type","text","id","fullname","formControlName","fullname",1,"form-control","is-invalid"],["for","gender",1,"form-label"],["name","gender","id","gender","formControlName","gender",1,"form-control","is-invalid"],["value","MALE"],["value","FEMALE"],["value","OTHER"],["type","text","id","fullname","formControlName","age",1,"form-control","is-invalid"],[1,"form-outline","mb-4"],["for","email",1,"form-label"],["type","email","id","email","formControlName","email",1,"form-control","is-invalid"],["for","password",1,"form-label"],["type","password","id","password","formControlName","password",1,"form-control","is-invalid"],["for","confirmPassword",1,"form-label"],["type","password","id","confirmPassword","formControlName","confirmPassword",1,"form-control","is-invalid"],[1,"form-check","d-flex","justify-content-between","mb-4"],["for","form2Example33",1,"form-check-label"],["type","checkbox","value","","id","form2Example33","checked","",1,"form-check-input"],[3,"routerLink"],["type","submit",1,"btn","btn-primary","btn-block","mb-4","w-50",3,"disabled","click"],["type","button",1,"btn","btn-link","btn-floating","mx-1"],[1,"fab","fa-facebook-f"],[1,"fab","fa-google"],[1,"fab","fa-twitter"],[1,"fab","fa-github"]],template:function(r,n){1&r&&(e.TgZ(0,"section"),e._UZ(1,"div",0),e.TgZ(2,"div",1)(3,"div",2)(4,"div",3)(5,"div",4)(6,"div",5),e._UZ(7,"img",6),e.qZA(),e.TgZ(8,"div",7)(9,"h2",8),e._uU(10,"\u0110\u0103ng k\xed t\xe0i kho\u1ea3n cho ITCommunity"),e.qZA()(),e.TgZ(11,"form",9)(12,"div",10)(13,"div",11)(14,"div",12)(15,"label",13),e._uU(16,"Username"),e.qZA(),e._UZ(17,"input",14),e.qZA()(),e.TgZ(18,"div",11)(19,"div",12)(20,"label",15),e._uU(21,"Fullname"),e.qZA(),e._UZ(22,"input",16),e.qZA()()(),e.TgZ(23,"div",10)(24,"div",11)(25,"div",12)(26,"label",17),e._uU(27,"Gender"),e.qZA(),e.TgZ(28,"select",18)(29,"option",19),e._uU(30,"Male"),e.qZA(),e.TgZ(31,"option",20),e._uU(32,"Female"),e.qZA(),e.TgZ(33,"option",21),e._uU(34,"Other"),e.qZA()()()(),e.TgZ(35,"div",11)(36,"div",12)(37,"label",15),e._uU(38,"Age"),e.qZA(),e._UZ(39,"input",22),e.qZA()()(),e.TgZ(40,"div",23)(41,"label",24),e._uU(42,"Email address"),e.qZA(),e._UZ(43,"input",25),e.qZA(),e.TgZ(44,"div",23)(45,"label",26),e._uU(46,"Password"),e.qZA(),e._UZ(47,"input",27),e.qZA(),e.TgZ(48,"div",23)(49,"label",28),e._uU(50,"Confirm Password"),e.qZA(),e._UZ(51,"input",29),e.qZA(),e.TgZ(52,"div",30)(53,"div")(54,"label",31),e._uU(55," Subscribe to our newsletter "),e.qZA(),e._UZ(56,"input",32),e.qZA(),e.TgZ(57,"div")(58,"a",33),e._uU(59,"\u0110\u0103ng nh\u1eadp"),e.qZA()()(),e.TgZ(60,"div",5)(61,"button",34),e.NdJ("click",function(){return n.register()}),e._uU(62," Sign up "),e.qZA()(),e.TgZ(63,"div",7)(64,"p"),e._uU(65,"Information contact with ITCommunity:"),e.qZA(),e.TgZ(66,"button",35),e._UZ(67,"i",36),e.qZA(),e.TgZ(68,"button",35),e._UZ(69,"i",37),e.qZA(),e.TgZ(70,"button",35),e._UZ(71,"i",38),e.qZA(),e.TgZ(72,"button",35),e._UZ(73,"i",39),e.qZA()()()()()()()()),2&r&&(e.xp6(11),e.Q6J("formGroup",n.infoRegister),e.xp6(6),e.ekj("is-invalid",n.isControlInvalid(n.infoRegister,"username"))("is-valid",n.isControlValid(n.infoRegister,"username")),e.xp6(5),e.ekj("is-invalid",n.isControlInvalid(n.infoRegister,"fullname"))("is-valid",n.isControlValid(n.infoRegister,"fullname")),e.xp6(6),e.ekj("is-invalid",n.isControlInvalid(n.infoRegister,"gender"))("is-valid",n.isControlValid(n.infoRegister,"gender")),e.xp6(11),e.ekj("is-invalid",n.isControlInvalid(n.infoRegister,"age"))("is-valid",n.isControlValid(n.infoRegister,"age")),e.xp6(4),e.ekj("is-invalid",n.isControlInvalid(n.infoRegister,"email"))("is-valid",n.isControlValid(n.infoRegister,"email")),e.xp6(4),e.ekj("is-invalid",n.isControlInvalid(n.infoRegister,"password"))("is-valid",n.isControlValid(n.infoRegister,"password")),e.xp6(4),e.ekj("is-invalid",!n.comparePassword()&&n.infoRegister.get("confirmPassword").touched)("is-valid",n.comparePassword()&&n.infoRegister.get("confirmPassword").touched),e.xp6(7),e.Q6J("routerLink",e.DdM(31,E)),e.xp6(3),e.Q6J("disabled",n.infoRegister.invalid))},dependencies:[u.rH,t._Y,t.YN,t.Kr,t.Fj,t.EJ,t.JJ,t.JL,t.sg,t.u]}),o})(),R=(()=>{class o{constructor(r){this.translateService=r}ngOnInit(){}}return o.\u0275fac=function(r){return new(r||o)(e.Y36(f.sK))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-auth"]],decls:1,vars:0,template:function(r,n){1&r&&e._UZ(0,"router-outlet")},dependencies:[u.lC]}),o})();var L=a(7741),x=a(8168);const U=function(){return["/auth/register"]},_=[{path:"",component:R,children:[{path:"",redirectTo:"login",pathMatch:"full"},{path:"login",component:(()=>{class o{constructor(r,n,i,m,y){this.authService=r,this.router=n,this.localStorageHelperService=i,this.userService=m,this.notifyService=y,this.infoLogin=this.initFormLogin()}ngOnInit(){}initFormLogin(){return new t.cw({username:new t.NI("",[t.kI.required]),password:new t.NI("",[t.kI.required])})}onSubmit(){const r={username:this.infoLogin.value.username,password:this.infoLogin.value.password},n=new L.W;this.authService.login(r,!1).pipe((0,x.b)(i=>{this.localStorageHelperService.saveToken(i.accessToken.toString()),this.localStorageHelperService.saveRefreshToken(i.refreshToken.toString()),this.localStorageHelperService.saveIsVerify(i.isConfirmEmail),this.localStorageHelperService.saveRole(i.isAdmin),n.accessToken=i.accessToken,n.refreshToken=i.refreshToken,n.isConfirmEmail=i.isConfirmEmail,n.isConfirmEmail=i.isConfirmEmail,n.isAdmin=i.isAdmin}),(0,g.w)(()=>this.userService.getMe()),(0,g.w)(i=>(i.password=r.password,this.localStorageHelperService.addUser(i),this.authService.isLogin(!0),n&&n.isConfirmEmail?(this.router.navigate(["/home/newest/posts"]),(0,b.of)(null)):(this.router.navigate(["/auth/validate-email"]),this.authService.sendOTP(i.username)))),(0,s.K)(i=>(this.notifyService.error("Login failed please field again!"),(0,b.of)(null)))).subscribe(i=>{})}}return o.\u0275fac=function(r){return new(r||o)(e.Y36(c.e),e.Y36(u.F0),e.Y36(d.w),e.Y36(T.K),e.Y36(v.c))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-login"]],decls:30,vars:4,consts:[[1,"vh-100",2,"background-color","#508bfc"],[1,"h-100",3,"formGroup"],[1,"container","py-5","h-100"],[1,"row","d-flex","justify-content-center","align-items-center","h-100"],[1,"col-12","col-md-8","col-lg-6","col-xl-5"],[1,"card","shadow-2-strong",2,"border-radius","1rem"],[1,"card-body","p-5"],[1,"d-flex","justify-content-center"],["src","../../../../assets/images/logo-header-250x250.png","width","100","alt",""],[1,"text-center","mt-2"],[1,"mb-5"],[1,"form-outline","mb-4"],["for","typeEmailX-2",1,"form-label"],["type","email","id","typeEmailX-2","formControlName","username",1,"form-control","form-control-lg"],["for","typePasswordX-2",1,"form-label"],["type","password","id","typePasswordX-2","formControlName","password",1,"form-control","form-control-lg"],[1,"form-check","d-flex","justify-content-between","mb-4"],["type","checkbox","value","","id","form1Example3",1,"form-check-input"],["for","form1Example3",1,"form-check-label","ms-2"],[1,"ms-auto","text-main",3,"routerLink"],["type","submit",1,"btn","btn-primary","btn-lg","btn-block","w-100",3,"disabled","click"]],template:function(r,n){1&r&&(e.TgZ(0,"section",0)(1,"form",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6)(7,"div",7),e._UZ(8,"img",8),e.qZA(),e.TgZ(9,"div",9)(10,"h3",10),e._uU(11,"\u0110\u0103ng nh\u1eadp v\xe0o ITCommunity"),e.qZA()(),e.TgZ(12,"div",11)(13,"label",12),e._uU(14,"Email"),e.qZA(),e._UZ(15,"input",13),e.qZA(),e.TgZ(16,"div",11)(17,"label",14),e._uU(18,"Password"),e.qZA(),e._UZ(19,"input",15),e.qZA(),e.TgZ(20,"div",16)(21,"div"),e._UZ(22,"input",17),e.TgZ(23,"label",18),e._uU(24," Remember password "),e.qZA()(),e.TgZ(25,"div")(26,"a",19),e._uU(27,"T\u1ea1o t\xe0i kho\u1ea3n"),e.qZA()()(),e.TgZ(28,"button",20),e.NdJ("click",function(){return n.onSubmit()}),e._uU(29,"Login"),e.qZA()()()()()()()()),2&r&&(e.xp6(1),e.Q6J("formGroup",n.infoLogin),e.xp6(25),e.Q6J("routerLink",e.DdM(3,U)),e.xp6(2),e.Q6J("disabled",n.infoLogin.invalid))},dependencies:[u.rH,t._Y,t.Fj,t.JJ,t.JL,t.sg,t.u],styles:[".gradient-custom-2[_ngcontent-%COMP%]{background:#fccb90;background:linear-gradient(to right,#ee7724,#d8363a,#dd3675,#b44593)}@media (min-width: 768px){.gradient-form[_ngcontent-%COMP%]{height:100vh!important}}@media (min-width: 769px){.gradient-custom-2[_ngcontent-%COMP%]{border-top-right-radius:.3rem;border-bottom-right-radius:.3rem}}.text-main[_ngcontent-%COMP%]{color:var(--main-colors)!important}"]}),o})()},{path:"register",component:S},{path:"validate-email",component:I}]}];let P=(()=>{class o{}return o.\u0275fac=function(r){return new(r||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[u.Bz.forChild(_),u.Bz]}),o})(),q=(()=>{class o{}return o.\u0275fac=function(r){return new(r||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({providers:[c.e,d.w],imports:[h.ez,P,t.UX,f.aw,Z.ot]}),o})()},9549:(k,p,a)=>{a.d(p,{c:()=>h});var d=a(4537),c=a(8292);let h=(()=>{class t{constructor(s){this.toastr=s}success(s,e="Successfully"){this.toastr.success(s,e)}error(s,e="Error"){this.toastr.error(s,e)}warning(s,e="Warning"){this.toastr.warning(s,e)}info(s,e="Info"){this.toastr.info(s,e)}}return t.\u0275fac=function(s){return new(s||t)(d.LFG(c._W))},t.\u0275prov=d.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()}}]);